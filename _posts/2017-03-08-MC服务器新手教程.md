---
permalink: /posts/server-tutorial-new
layout: post
title:  MC服务器新手教程
categories: minecraft
tags:
---

* content
{:toc}

Minecraft除了单机一个人玩外，还能局域网与朋友联机玩，除此之外，还能连接到远程服务器，与不同地区的玩家一起玩耍.
那么，该如何开启一个MC服务器呢？




## 一. MC服务器是什么?

MC可以单机玩,也可以联机玩,联机主要有两种方式:

一种是`局域网内联机`,这种方式只要打开MC客户端,然后在游戏内点击开启局域网模式,在同一个局域网内的客户端就能连上了,
适合几个人在一起玩,但只能是MC原版的玩法,没有额外的功能,比较单调.

另一种就是`开启MC服务器`联机,这种方式更加通用,不同地区的玩家都能加入进来,而且通过插件可以改变游戏的玩法.

### MC服务器有什么用?
1. 不同地区的玩家可以一起玩,一起建筑,一起打怪
2. 可以通过插件来改变游戏的玩法,增加更多的特性,比如增加金币功能(打怪掉落金币,可以用金币购买其它玩家的物品),增加领地功能(防止其它人破坏你的建筑)

## 二. MC服务器开哪里?
开服主要有以下几种方式:

### 1. 自己电脑上开服
一般用做`测试`目的.

比如本地开个服,测试一下指定版本的某个插件能否正常使用.

你可能会问,我用这种方式开服,其它人有办法连接上来吗?
可以百度一下`动态IP`,`内网IP`与`端口映射`,这里暂时不作过多介绍.

### 2. 租用服务器开服
可以在淘宝或百度上搜索`服务器租用`,租用其它服务商的服务器,
一般可以租`VPS`或`独立主机`,
VPS通常用的虚拟化技术,就是在一台服务器上弄出多个独立的系统出租给不同的用户,因此稳定性相对差些,
独立主机则是对应物理机,质量相对更高,但也更贵.

初期开服适合使用这种方式.

### 3. 购买服务器托管
这种方式初期购买花费较高(购买服务器物理机的费用),然后找机房托管,托管费通常相对比租用要便宜点.

优点很明显,服务器是你自己的,质量与性能都有保证,一般正规的大服都会采用此方式.

但难度也摆在那里,从购买机器,挑选机房,运送机器,怎么不被坑就看你的能力了.

### 4. 租用专门的MC服务器
因为MC开服需求比较大,因此也出现了很多专业的MC服务器出租商,
他们可能提供专门的MC服务器网页管理系统方便管理服务器,
也可能针对MC服务端在网络,性能,稳定性上做了一些优化.

### 总结
不管选用哪种方式开服,主要还看服务提供商的质量,比如是否有断电,崩服,重启的情况,网络质量是否稳定,是否会掉线等.

## 三. MC服务端介绍
MC服务端本质只是一个`软件`,开启这个软件后,其它客户端可以通过网络远程连接上来,两个客户端都连接进来,就能看到对方,一起玩了.

再进一步,MC服务端是一个`java软件`,下载下来后只有一个jar文件,那么怎么开启呢?既然是java软件,肯定要安装java,然后用java来打开这个jar文件,服务端就启动了.

### 数据存在哪里?
你可能会问,服务端开启后,数据存在哪里?

* `服务端本身的数据`默认存放在文件里,比如服务端的配置文件,或者你在游戏中使用命令设置玩家为op,那op信息也保存在文件里,或者你对世界的改变也存放在世界文件里
* `插件数据`一般也存放在文件里,但有些插件可能会将数据存放在`数据库`中

### 服务端如何开启?
一般使用`java脚本`来开启服务端,以`windows服务器`举例,步骤如下:

1. 新建一个名为`start.bat`(后缀是bat就行)的文件
2. 用文件编辑器打开后输入`java -jar xxx.jar`(其中xxx.jar换成服务端的jar名),然后保存
3. 双击刚新建的start.bat脚本文件,会出现一个命令行窗口,启动过程中会不断地打印日志.
4. 日志基本上都是英文的(因为服务端的作者是外国人),在日志刷得基本上结束后,会看到类似`Done (14.786s)! For help, type "help" or "?"`的日志,服务端就算启动完成了,此时客户端也可以连进游戏了.

*此外,也有很多服务端管理工具提供更简便的开服方式*

#### 双击start.bat脚本后,命令行窗口闪了一下就退了?
如果出现这种情况,一般是java路径没配置之类的原因,可以用文本编辑器打开`start.bat`脚本文件,在最后换行输入`pause`,
这样窗口就不会立即退出,可以看到出错原因.

#### 第一次运行服务端,没启动成功?
在第一次启动服务端时,会提示`You need to agree to the EULA in order to run the server. Go to eula.txt for more info.`然后自动停止

你需要打开生成的`eula.txt`,将里面的`eula=false`改成`eula=true`然后保存(表示同意服务端相关的协议),
再启动服务端就可以了.

### 服务端如何关闭?

一般使用命令来关闭服务端,在控制台界面输入`stop`即可.

要注意的是,`不要直接点命令窗口右上角的关闭按钮`,否则关闭的只是命令窗口,服务端还在后台运行着.
这样下次启动服务端时会提示`**** FAILED TO BIND TO PORT!`,即端口被占用了.
如果出现这种情况了,打开任务管理器,找到服务端的java进程然后杀死,但这种非正常的关闭会导致数据保存不完整.

*此外,也有很多服务端管理工具提供更简便的关服/重启方式*

### 名词解释
* `服务端`： 这里指的是spigot服务端，spigot服务端的特点是可以装插件，但不能装MOD（要想装MOD必须用另外一个不同的服务端，这里不讨论）,服务端本身只有一个jar文件,运行起来后会生成其它必须的文件,至于服务端jar文件的名字并不重要，改成其它名字也并不影响.
* `服务端目录`： 指服务端jar文件所在的目录
* `插件目录`: 指`服务端目录/plugins`目录
* `插件`： 装在插件目录内的jar文件就是插件，同服务端一样，插件的名字也可以改,比如从英文改成中文方便理解（极少数除外）
* `插件数据文件夹`： 每个插件都有个数据文件夹，用来存放插件的配置与数据等信息，位置在`插件目录/插件名`目录内，注意插件名并非插件的jar文件名（因为上面说过了，jar文件名是可以随意改的），而是定义在插件内的唯一的名字，一般插件名与插件jar名相同或类似，如果不清楚可以去下载插件的地方查看介绍.

## 不同Minecraft服务端之间的关系

* `官服`： 指的是MC官方服务端，但功能比较简单
* `水桶服(Bukkit/CraftBukkit)`: 这是社区开发的服务端，在官服的基础上增加了丰富的功能，也是有名的`插件服`.

  Bukkit与CraftBukkit的区别?Bukkit是一个接口，CraftBukkit是它的实现

* `水龙头服(Spigot)`： 此服务端是在水桶服之后出的，最显著的特点是在水桶服的基础上做了优化，提高了性能,也同样是`插件服`

## 服务端下载

以`spigot`服务端为例,下载地址如下:

### 一. 官方方法
此方法可以获取最新的服务端,但缺点是复杂且容易失败.

官方提供了一个构建工具`[BuildTools](https://hub.spigotmc.org/jenkins/job/BuildTools/)`([使用方法](https://www.spigotmc.org/wiki/buildtools/))

步骤如下:

1. 下载[Java](http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html)(运行minecraft需要java,开服同样需要它)
2. 下载[Git](http://msysgit.github.io/)(这是版本控制工具,开发者常用的)
3. 下载[BuildTools](https://hub.spigotmc.org/jenkins/job/BuildTools/lastSuccessfulBuild/artifact/target/BuildTools.jar)(这是开发spigot的作者搞的构建工具,就是运行一下,就给你自动下载文件,组装文件,产出最终可用的服务端文件)

再下载此构建工具`BuildTools.jar`,然后打开`git bash`界面(windows系统下不能使用普通的命令行界面),输入`java -jar BuildTools.jar`来运行它,在经过漫长的构建过程后,会生成一堆文件
