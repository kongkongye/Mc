---
permalink: /posts/project-maven
layout: post
title: 运行期项目管理工具 
categories: 工具
tags: 工具 项目管理 
---

* content
{:toc}

在进行`开发`时我们可以使用Maven来管理项目的诸多`依赖`，那么一个项目`运行`起来后，能否用类似的工具来管理项目的诸多`插件`呢？

因为目前并没有适用此类的成熟工具，因此萌生了自己编写一个这种工具的想法，在这里记录一下想法。




## 一. 使用场景介绍
* `适合语言`： JAVA
* `适合人群`： 项目的用户（通常没有开发能力的）
* `适合环境`： 运行期的项目

通常在进行JAVA`开发`时，可以使用maven进行项目依赖管理，这是因为一个项目可能有很多的依赖，所以才会需要有个工具去管理这些依赖。
但如果一个项目在`运行`时，也可以装很多的插件呢？那么这些插件同样需要一个依赖管理工具。

那么Maven是否适用呢？毕竟是一个现成又成熟的工具，如果可以直接用那将会十分的方便。
但答案或许是**并不适用**，首先，Maven主要面向的是开发人员，使用`xml`进行配置，但一个项目在`运行`期装哪些插件是由项目的使用者也就是用户来决定，
而用户不了解也不应该让他们去了解xml是怎么配置的，提供给用户的应该是一个`图形化`的操作界面。
那么Maven能否提供接口来制作出一个图形界面给用户呢？。。。

总之，Maven是给开发人员在开发项目时使用的项目管理工具，而使用场景变了，用户类型变了，那就像不合脚的鞋子一样，还不如重新做一个，不然使用过程中遇到坑也不一定能解决。

因此，如果一个项目运行起来后有很多插件,则可以使用此项目来管理这些插件及其依赖。那这样一个项目的需求是什么，难点在哪里，下面就来具体分析。

## 二. 前提条件
* `单主端`: 项目必须有一个`主端`，这个端是`有版本`的，版本可能会慢慢地更新变化
* `多插件`: 项目有多个`插件`，插件也是`有版本`的，并且可以是自己或其它人开发的，如果没有插件或插件数量非常少或全部是自己开发的，那就没必要使用此管理工具
* `多用户`: 项目是给多个不同的`用户`使用的，如果项目仅仅是给有限少数的几个用户使用的，或自己用的，那也没必要使用此项目管理工具

## 三. 需求

### 图形化界面
整个项目必须是图形化界面操作的，这是因为项目面向项目使用者，通常他们没有开发能力也没有耐心去学习开发相关知识，因此那些复杂的配置文件与规则，专业的出错提示都可能不适用。

### 管理现有资源
比如在这个管理工具出现前，某个项目已经有许多的插件了，那么此工具应当能够通过简单的方式来给插件添加附属信息。
这里有几个关键点：

1. 简单
2. 外接，即不需要改动插件文件本身，是`非侵入性`的，比如给插件增加个描述文件即可变为依赖
3. 第三方可以 

当然，只需要能覆盖大部分的现成插件即可，少数插件特殊情况可以特殊考虑，不需要从理论上保证100%的覆盖。

## 四. 难点

### 1. 版本控制
不管是Maven还是npm,所有的项目管理工具几乎都会遇到版本控制的问题，这是复杂与困难的。

比如

### 2. 依赖管理
依赖与版本结合在一起，会使情况更加复杂。
比如

### 3. 依赖过多
像npm,在开发时会有很多的依赖，不过构建后并没有这么多的依赖。而Maven，一般开发与运行时依赖数量是大致相同的。
而此项目比较类似Maven，因此依赖数量应该不是很大的问题。先记一下这种可能性。

## 五. 概要设计
作为一个开放型，扩展性强的项目，不能定死某些东西，也不能过于自由从而导致混乱，而应当定好整体架构，扩展是在架构内的扩展，是架构提供的扩展，而不能超出架构范围或改变架构。

### 资源
资源就是操作的目标对象，每种资源类型都有对应的`资源管理器`，资源管理器知道怎么操作资源，如清理，安装等

属性：

* 类型信息
  * 类型
  * 使用哪种资源管理器
  * 提供给资源管理器的额外配置信息
* 名称
* 版本
* 适合哪些版本的主端
  * 哪些版本适合
  * 哪些版本不适合
  * 其它的版本都是未测试的
* 安装定义，指明资源是如何安装的，一个资源的安装尽量不要影响其它资源。如果有副作用需要提示用户。
* 清理定义，指明资源是如何清理的，一个资源的清理尽量干净，并且不要影响其它资源。如果有残留或副作用需要提示用户。
* 依赖列表，依赖的也是资源
* 作者

### 插件
这里的插件指此管理工具的插件。
插件是用来执行目标的。

### 阶段
类似Maven的阶段（Phase），在一个阶段内可以配置执行多个`目标`。

阶段如`清理`，`检查`，`安装`

### 目标
类似Maven的目标（Goal）,一个目标即是一个具体的动作，调用插件，提供配置，即可进行操作。

## 六. 测试

### 现成的分析
管理工具只是作为辅助工具，提供高层的管理方式，但并不禁止底层的直接修改，自然也不能保证项目必然是正常的，此外也不能保证各个第三方资源的定义是没有问题，因此出现各种问题都是正常的。
此测试需要让此管理工具分析一个任意的项目，不能因为项目的错误配置而使工具本身崩溃，同时不能因为中途的错误而中止整个分析，分析结果应当能显示哪些配置是没问题的，哪些是有问题的。

### 资源定义的正确性测试
增加与删除一个资源，查看有没残留，如果有残留或其它副作用有没提示用户。
